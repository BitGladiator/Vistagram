# Common proxy headers - included in all service locations

# HTTP version
proxy_http_version 1.1;

# Pass original host
proxy_set_header Host $host;

# Pass real client IP
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;

# Pass auth headers (JWT extracted by services)
proxy_set_header Authorization $http_authorization;

# Pass any custom headers
proxy_set_header X-User-Id $http_x_user_id;
proxy_set_header X-Username $http_x_username;

# Keepalive
proxy_set_header Connection "";

# Buffer settings
proxy_buffering on;
proxy_buffer_size 4k;
proxy_buffers 8 4k;